<!DOCTYPE html>
<html>

<head>
    <title>–ó–∞–∫–∞–∑ –¥–æ—Å—Ç–∞–≤–∫–∏</title>
    <link rel="stylesheet" href="static/css/styleguide2.css"/>
    <link rel="stylesheet" href="static/css/style3.css"/>
</head>

<body>
<div class="mmain">
    <form action="/" method="post">
        <div class="ssidebar">
            <div class="sushi">
                <div class="title">–°—É—à–∏ –ë–∞–π—Ä–∞–º</div>

                <div class="date">&nbsp;üëã</div>
            </div>


            <div class="div">
                <div class="frame">
                    <div class="text-wrapper">–ù–û–ú–ï–† –¢–ï–õ–ï–§–û–ù–ê</div>
                </div>
                <input class="view text-wrapper-3" type="text" id="tel_input" name="tel_input" required>
            </div>
            <div class="div">
                <div class="frame">
                    <div class="text-wrapper">–ó–ê–ö–ê–ó</div>
                </div>
                <textarea class="vieww text-wrapper-3 textarea-autoheight" id="menu_input" name="menu_input"
                          required></textarea>
            </div>
            <div class="div">
                <div class="frame">
                    <div class="text-wrapper">–ê–î–†–ï–°</div>
                </div>
                <input class="view text-wrapper-3" type="text" id="address_input" name="address_input" required>
            </div>
            <div class="div">
                <div class="frame">
                    <div class="text-wrapper">–ù–ê –°–ö–û–õ–¨–ö–û –ß–ï–õ–û–í–ï–ö</div>
                </div>
                <input class="view text-wrapper-3" type="text" id="clientsnumber_input" name="clientsnumber_input"
                       required>
            </div>
            <div class="div">
                <div class="frame">
                    <div class="text-wrapper">–ú–ï–¢–û–î –û–ü–õ–ê–¢–´</div>
                </div>
                <input class="view text-wrapper-3" type="text" id="method_input" name="method_input" required>
            </div>

            <div class="text-wrapper-6" id="total_cost">0 ‚ÇΩ</div>
            <div class="div">
                <input class="view2 label-2" type="submit" value="–°–æ–∑–¥–∞—Ç—å –∑–∞–∫–∞–∑">
            </div>
        </div>

    </form>

    <div class="bbody" id="dishesContainer"></div>

</div>

<script>
    // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º AJAX-–∑–∞–ø—Ä–æ—Å –Ω–∞ —Å–µ—Ä–≤–µ—Ä –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–ø–∏—Å–∫–∞ –±–ª—é–¥
    fetch('/get_dishes')
      .then(response => response.json())
      .then(data => {
        // –°–æ–∑–¥–∞–µ–º –∫–Ω–æ–ø–∫–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –±–ª—é–¥–∞
        const dishesContainer = document.getElementById('dishesContainer');       // id="dishesContainer" –¥–ª—è html
        data.dishes.forEach(dish => {
          const dishButton = document.createElement('div');
          dishButton.className = 'frame-3';
          dishButton.innerHTML = `<div class="text-wrapper-4">${dish}</div>`;
          dishButton.addEventListener('click', () => insertText(dish));
          dishesContainer.appendChild(dishButton);
        });
      })
      .catch(error => console.error('Error:', error));

    // –û—Å—Ç–∞–ª—å–Ω–æ–π –≤–∞—à JavaScript –∫–æ–¥...
</script>
  

<script>
    // –î–æ–±–∞–≤–ª—è–µ–º JavaScript-—Ñ—É–Ω–∫—Ü–∏—é –¥–ª—è –≤—Å—Ç–∞–≤–∫–∏ —Ç–µ–∫—Å—Ç–∞ –≤ –ø–æ–ª–µ –≤–≤–æ–¥–∞
    function insertText(text) {
      const menuInput = document.getElementById("menu_input");

      // –ü–æ–ª—É—á–∞–µ–º —Ç–µ–∫—É—â–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ–ª—è –≤–≤–æ–¥–∞
      let currentValue = menuInput.value;

      // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ —É–∂–µ —Ç–µ–∫—Å—Ç –≤ –ø–æ–ª–µ –≤–≤–æ–¥–∞
      if (currentValue) {
        // –ï—Å–ª–∏ –µ—Å—Ç—å, –¥–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤—ã–π —Ç–µ–∫—Å—Ç –ø–æ—Å–ª–µ –∑–∞–ø—è—Ç–æ–π —Å –ø—Ä–æ–±–µ–ª–æ–º
        currentValue += ', ' + text;
      } else {
        // –ï—Å–ª–∏ –Ω–µ—Ç, —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –Ω–æ–≤—ã–π —Ç–µ–∫—Å—Ç
        currentValue = text;
      }

      // –í—Å—Ç–∞–≤–ª—è–µ–º —Ç–µ–∫—Å—Ç –≤ –ø–æ–ª–µ –≤–≤–æ–¥–∞
      menuInput.value = currentValue;

      // –í—ã–∑—ã–≤–∞–µ–º —Ñ—É–Ω–∫—Ü–∏—é –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –æ–±—â–µ–π —Å—É–º–º—ã
      updateTotalCost();
    }
</script>


<script>
    const menuInput = document.getElementById("menu_input");
    const addressInput = document.getElementById("address_input");
    const totalCost = document.getElementById("total_cost");

    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ —Å–æ–±—ã—Ç–∏—è –≤–≤–æ–¥–∞
    menuInput.addEventListener("input", updateTotalCost);
    addressInput.addEventListener("input", updateTotalCost);

    function updateTotalCost() {
      // –ü–æ–ª—É—á–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏—è –∏–∑ –ø–æ–ª–µ–π —Ñ–æ—Ä–º—ã
      const menu = menuInput.value;
      const address = addressInput.value;

      console.log("Sending request with menu:", menu, "and address:", address);

      // –í—ã–ø–æ–ª–Ω—è–µ–º –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –∑–∞–ø—Ä–æ—Å –∫ —Å–µ—Ä–≤–µ—Ä—É –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –æ–±—â–µ–π —Å—Ç–æ–∏–º–æ—Å—Ç–∏
      fetch(`/calculate_total_cost?menu=${menu}&address=${address}`)
        .then(response => response.json())
        .then(data => {
          console.log("Received response data:", data);

          // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –æ–±—â–µ–π —Å—É–º–º—ã
          totalCost.textContent = `${data.totalCost} ‚ÇΩ`;
        })
        .catch(error => console.error('Error:', error));
    }
</script>


</body>

</html>